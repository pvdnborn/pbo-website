---
layout: post
title:  "WVD and VDI automation: Change in language pack installation on Windows 10 1809 and higher"
date:   2018-03-14 18:40:00 +0100
categories:  VDI, multi user, Language Experience Pack, '1903', '1909', LIB, LIP, '1809', WVD, LXP, Windows Virtual Desktop, Windows 10 for Virtual Desktops, non-persistent, Windows 10
---

Currently I’m working on a Windows 10 Enterprise 1903 CAD-VDI project now. One goal of this project is to deploy the golden master image with Automation.  
  
My customer has Spanish, French, English, Dutch, Romanian and Russian speaking employees and needs the Windows User Interface in this language. As of Windows 1809 and higher, Microsoft changed things with the language pack installation. They call this a Local Experience Pack (LXP in short).  
  
Prior to Windows 10 1809 an installation of a Language Interface Pack (LIP in short) was easy. Just download the **lp.cab** of the language pack and install it with DISM or lpksetup.exe. Example old commands:  

*   dism.exe /online /add-package /packagepath:D:\\langpacks\\de-de\\lp.cab
*   lpksetup /i es-ES /r /s /p D:\\langpacks\\es-es\\lp.cab

Installation of LXP are different then good old LIPs. So, this is what I want to share with you. More information here: [https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/add-language-packs-to-windows](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/add-language-packs-to-windows)  
  
The User Experience changed when using LXP in Windows 10 >=1809. With LXP, things are more user focused from the modern settings panel. And more user input is needed, which is difficult for automation. If an end-user wants to select their “Windows Display Language”. The user needs to add a preferred language first (even if the LXP is already installed on the machine level). After that, he’s able to select the Windows Display Language of choice (which is a subset of the user defined preferred language).  

[![]({{ site.url }}/images/2019-10-18/2019-10-18-image001.png)](https://1.bp.blogspot.com/-q6PgD1KIZ34/XanM6EmJCXI/AAAAAAAADkk/dDqKtdtHXr8j96uOCSEBjywkW3t6w8zjACEwYBhgL/s1600/image001.png)

  
If you want to automate this process in a pooled VDI or Windows Virtual Desktop environment all the workers need to have the LXP installed upfront or your users need admin rights. If you want to automate the installation of LXP to a golden master or persistent images, the process is as follows:  

1.  Download the “Windows 10 Language Pack” ISO for your Windows build from the Windows Volume Licensing or MSDN website. (i.e. “Windows 10 Language Pack, version 1903”) 
2.  Install the required Language Pack cab language files to the system. (i.e. “Microsoft-Windows-Client-Language-Pack\_x64\_es-es.cab”)
3.  Install the corresponding LXP APPX file to the system. (i.e. “LanguageExperiencePack.es-ES.Neutral.appx”)
4.  Add the language to the “preferred language” **per user!**

  
I’ve created a powershell script, which automates the steps 2 to 4. The script can be downloaded here: [https://vandenbornit-my.sharepoint.com/:u:/g/personal/patrick\_vandenborn\_it/EdzXPl6eDB5Fj-uDxgRZsf4BkyMyGjRDZ050r62PoVs3eA?e=7yMJIK](https://vandenbornit-my.sharepoint.com/:u:/g/personal/patrick_vandenborn_it/EdzXPl6eDB5Fj-uDxgRZsf4BkyMyGjRDZ050r62PoVs3eA?e=7yMJIK) or copy paste the code at the bottom of this blog.  
  
Use the powershell script as follows:  
1.    Create a folder of choice and create two subfolders (LangPacks and LXP)  
[![]({{ site.url }}/images/2019-10-18/2019-10-18-image003.png)](https://1.bp.blogspot.com/-axNxYTaIeBo/XanM6FRgEzI/AAAAAAAADmI/qxY0IGAilc8q_mnAMVF6Kl1_qR1xDVpIQCEwYBhgL/s1600/image003.png)
  
2.    Copy the cab files from the ISO (x86 or x64 folder) to the LangPacks directory  
[![]({{ site.url }}/images/2019-10-18/2019-10-18-image005.png)](https://1.bp.blogspot.com/-f2yO72Al8gE/XanM7HX9T0I/AAAAAAAADl8/8KMDtX_LGmMCA_66gngb8-I-E3VcPLZ4QCEwYBhgL/s1600/image005.png)
  
3.    Copy the corresponding LXP folders form the ISO (LocalExperiencePacks) to the LXP directory  
[![]({{ site.url }}/images/2019-10-18/2019-10-18-image007.png)](https://1.bp.blogspot.com/-11A0zlBc6gE/XanM7vZaHkI/AAAAAAAADl0/pewyLtQvweUGC0Uk2Pb1_lvcD6kkUp8fQCEwYBhgL/s1600/image007.png)
  
4.    Edit the Install\_Win10\_LXP.ps1 script and change the global settings:  
![]({{ site.url }}/images/2019-10-18/2019-10-18-image009.png)  
   
5.    Add the Install\_Win10\_LXP.ps1 to your automation software or run as admin from PowerShell  
[![]({{ site.url }}/images/2019-10-18/2019-10-18-image011.png)](https://1.bp.blogspot.com/-KdQxSJ8D_-M/XanM81_usjI/AAAAAAAADl8/fms7bjn6ZAwOk_jaDa3j4iFxqvSyBHHbQCEwYBhgL/s1600/image011.png)
  
6.    The scripts detect missing files  
[![]({{ site.url }}/images/2019-10-18/2019-10-18-image013.png)](https://1.bp.blogspot.com/-ujZG_cBl5kw/XanM9V9x7aI/AAAAAAAADl4/XlTkRyiqJRgYNsFV9HiHOcgz8pmizrB4ACEwYBhgL/s1600/image013.png)
  
7.    When the script finishes, a powershell command is generated. Use this as a RunOnce login script for each user in your WVD or VDI environment:  
[![]({{ site.url }}/images/2019-10-18/2019-10-18-image015.png)](https://1.bp.blogspot.com/-a08WFo2lGpY/XanM93tWa3I/AAAAAAAADl8/uSgT3EH51NsOMT1iMfneePkK0WD1CzcegCEwYBhgL/s1600/image015.png)
  
8.    Run the powershell script in user context  
<table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid" style="border-collapse: collapse; border: none; mso-border-alt: solid windowtext .5pt; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-yfti-tbllook: 1184;"><tbody><tr style="mso-yfti-firstrow: yes; mso-yfti-irow: 0; mso-yfti-lastrow: yes;"><td style="border: solid windowtext 1.0pt; mso-border-alt: solid windowtext .5pt; padding: 0cm 5.4pt 0cm 5.4pt; width: 450.5pt;" valign="top" width="601"><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">###########################################</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># PowerShell Script for users or login script</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">###########################################</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #a82d00; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$prefered_list</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: dimgrey;">=</span> <span style="color: blue;">Get-WinUserLanguageList</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #a82d00; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$prefered_list</span><span style="color: dimgrey; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">.</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Add(<span style="color: darkred;">"es-es"</span>)</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #a82d00; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$prefered_list</span><span style="color: dimgrey; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">.</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Add(<span style="color: darkred;">"fr-fr"</span>)</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #a82d00; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$prefered_list</span><span style="color: dimgrey; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">.</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Add(<span style="color: darkred;">"nl-nl"</span>)</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Set-WinUserLanguageList</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;">(<span style="color: #a82d00;">$prefered_list</span>) <span style="color: navy;">-Force</span></span></div></td></tr></tbody></table>

[![]({{ site.url }}/images/2019-10-18/2019-10-18-image017.png)](https://1.bp.blogspot.com/-kqX8S14WAnY/XanM-UCPXbI/AAAAAAAADmA/SSek00jgV9MRfC7cuhC0pD0Rr4SmtKGyACEwYBhgL/s1600/image017.png)
  
9.    This adds the installed languages to the “preferred language list” automatically:  
[![]({{ site.url }}/images/2019-10-18/2019-10-18-image019.png)](https://1.bp.blogspot.com/-uRg8U8JJiNc/XanM-4Rq_6I/AAAAAAAADmE/ybVHtmkMnu49iwkqVjm3enK8xceOTbLdACEwYBhgL/s1600/image019.png)
  
The powershell script:  
<table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid" style="border-collapse: collapse; border: none; mso-border-alt: solid windowtext .5pt; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-yfti-tbllook: 1184;"><tbody><tr style="mso-yfti-firstrow: yes; mso-yfti-irow: 0; mso-yfti-lastrow: yes;"><td style="border: solid windowtext 1.0pt; mso-border-alt: solid windowtext .5pt; padding: 0cm 5.4pt 0cm 5.4pt; width: 1091.1pt;" valign="top" width="1455"><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#############################</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># Install Language pack Win10 1809 and higher</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># Created by Patrick van den Born (vandenborn.it)</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># MS Switched from lp.cab to APPX also called Local Experience Packs</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># More info: https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/add-language-packs-to-windows</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># This tool installs the needed CAB and APPX packages</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># You can download the Language Pack from your volume licensing channel website</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># In my case: "Windows 10 Language Pack, version 1903"</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># Create a folder structure like this</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LangPacks<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>i.e. D:\Win10-1903\LangPacks --&gt; Root folder for LangPacks</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LXP<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>i.e. D:\Win10-1903\LXP --&gt; Root folder for Local Experience Pack</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># Then copy required cab from ISO x64 or x86 folder, for example</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LangPacks\Microsoft-Windows-Client-Language-Pack_x64_es-es.cab</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LangPacks\Microsoft-Windows-Client-Language-Pack_x64_fr-fr.cab</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LangPacks\Microsoft-Windows-Client-Language-Pack_x64_nl-nl.cab</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># Then copy corresponding Local Experience Pack folders from ISO LocalExperiencePack folder, for example</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LXP\es-es\LanguageExperiencePack.es-ES.Neutral.appx</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LXP\es-es\License.xml</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LXP\fr-fr\LanguageExperiencePack.fr-FR.Neutral.appx</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LXP\fr-fr\License.xml</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LXP\nl-nl\LanguageExperiencePack.nl-NL.Neutral.appx</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># \LXP\nl-nl\License.xml</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># The cab and appx files needs to be installed as Admin</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># To activate the languages, this should be started as user and is marked at the end of this script</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">###############################################</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#####################</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># Global script vars</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#####################</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #a82d00; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$lp_root_folder</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: dimgrey;">=</span> <span style="color: darkred;">"D:\Win10-1903"</span> <span style="color: darkgreen;">#Root folder where the copied sourcefiles are</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #a82d00; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$architecture</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: dimgrey;">=</span> <span style="color: darkred;">"x64"</span> <span style="color: darkgreen;">#Architecture of cab files</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #a82d00; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$systemlocale</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: dimgrey;">=</span> <span style="color: darkred;">"nl-NL"</span> <span style="color: darkgreen;">#System local when script finishes</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#####################</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;"># Start installation of language pack on Win10 1809 and higher</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#####################</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #a82d00; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$installed_lp</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: dimgrey;">=</span> <span style="color: blue;">New-Object</span> <span style="color: blueviolet;">System.Collections.ArrayList</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkblue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">foreach</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> (<span style="color: #a82d00;">$language</span> <span style="color: darkblue;">in</span> <span style="color: blue;">Get-ChildItem</span> <span style="color: navy;">-Path</span> <span style="color: darkred;">"</span><span style="color: #a82d00;">$lp_root_folder</span><span style="color: darkred;">\LXP"</span>) {</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: darkgreen;">#check if files exist</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #a82d00;">$appxfile</span> <span style="color: dimgrey;">=</span> <span style="color: #a82d00;">$lp_root_folder</span> <span style="color: dimgrey;">+</span> <span style="color: darkred;">"\LXP\"</span> <span style="color: dimgrey;">+</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: dimgrey;">+</span> <span style="color: darkred;">"\LanguageExperiencePack."</span> <span style="color: dimgrey;">+</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: dimgrey;">+</span> <span style="color: darkred;">".Neutral.appx"</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #a82d00;">$licensefile</span> <span style="color: dimgrey;">=</span> <span style="color: #a82d00;">$lp_root_folder</span> <span style="color: dimgrey;">+</span> <span style="color: darkred;">"\LXP\"</span> <span style="color: dimgrey;">+</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: dimgrey;">+</span> <span style="color: darkred;">"\License.xml"</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #a82d00;">$cabfile</span> <span style="color: dimgrey;">=</span> <span style="color: #a82d00;">$lp_root_folder</span> <span style="color: dimgrey;">+</span> <span style="color: darkred;">"\LangPacks\Microsoft-Windows-Client-Language-Pack_"</span> <span style="color: dimgrey;">+</span> <span style="color: #a82d00;">$architecture</span> <span style="color: dimgrey;">+</span> <span style="color: darkred;">"_"</span> <span style="color: dimgrey;">+</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: dimgrey;">+</span> <span style="color: darkred;">".cab"</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: darkblue;">if</span> (<span style="color: dimgrey;">!</span>(<span style="color: blue;">Test-Path</span> <span style="color: #a82d00;">$appxfile</span>)) {</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: darkred;">" - File missing: </span><span style="color: #a82d00;">$appxfile</span><span style="color: darkred;">"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Red</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: darkred;">"Skipping installation of "</span><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: blueviolet;">+</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>} <span style="color: darkblue;">elseif</span> (<span style="color: dimgrey;">!</span>(<span style="color: blue;">Test-Path</span> <span style="color: #a82d00;">$licensefile</span>)) {</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: darkred;">" - File missing: </span><span style="color: #a82d00;">$licensefile</span><span style="color: darkred;">"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Red</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: darkred;">"Skipping installation of "</span><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: blueviolet;">+</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>} <span style="color: darkblue;">elseif</span> (<span style="color: dimgrey;">!</span>(<span style="color: blue;">Test-Path</span> <span style="color: #a82d00;">$cabfile</span>)) {</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: darkred;">" - File missing: </span><span style="color: #a82d00;">$cabfile</span><span style="color: darkred;">"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Red</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: darkred;">"Skipping installation of "</span><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: blueviolet;">+</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>} <span style="color: darkblue;">else</span> {</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: darkred;">" - Installing </span><span style="color: #a82d00;">$cabfile</span><span style="color: darkred;">"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Green</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Start-Process</span> <span style="color: navy;">-FilePath</span> <span style="color: darkred;">"dism.exe"</span> <span style="color: navy;">-WorkingDirectory</span> <span style="color: darkred;">"C:\Windows\System32"</span> <span style="color: navy;">-ArgumentList</span> <span style="color: darkred;">"/online /Add-Package /PackagePath=</span><span style="color: #a82d00;">$cabfile</span><span style="color: darkred;"> /NoRestart"</span> <span style="color: navy;">-Wait</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: darkred;">" - Installing </span><span style="color: #a82d00;">$appxfile</span><span style="color: darkred;">"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Green</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Start-Process</span> <span style="color: navy;">-FilePath</span> <span style="color: darkred;">"dism.exe"</span> <span style="color: navy;">-WorkingDirectory</span> <span style="color: darkred;">"C:\Windows\System32"</span> <span style="color: navy;">-ArgumentList</span> <span style="color: darkred;">"/online /Add-ProvisionedAppxPackage /PackagePath=</span><span style="color: #a82d00;">$appxfile</span><span style="color: darkred;"> /LicensePath=</span><span style="color: #a82d00;">$licensefile</span><span style="color: darkred;"> /NoRestart"</span> <span style="color: navy;">-Wait</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name <span style="color: darkred;">" - CURRENT USER - Add language to preffered languages (User level)"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Green</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #a82d00;">$prefered_list</span> <span style="color: dimgrey;">=</span> <span style="color: blue;">Get-WinUserLanguageList</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #a82d00;">$prefered_list</span><span style="color: dimgrey;">.</span>Add(<span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name)</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Set-WinUserLanguageList</span>(<span style="color: #a82d00;">$prefered_list</span>) <span style="color: navy;">-Force</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #a82d00;">$installed_lp</span><span style="color: dimgrey;">.</span>Add(<span style="color: #a82d00;">$language</span><span style="color: dimgrey;">.</span>Name)</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>}</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;">}</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Write-Host</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: darkred;">"</span><span style="color: #a82d00;">$systemlocale</span><span style="color: darkred;"> - Setting the system locale"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Green</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Set-WinSystemLocale</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: navy;">-SystemLocale</span> <span style="color: #a82d00;">$systemlocale</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkgreen; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">#Generating output for script</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Write-Host</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: darkred;">" "</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Write-Host</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: darkred;">"###########################################"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Blue</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Write-Host</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: darkred;">"PowerShell Script for users or login script"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Blue</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Write-Host</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: darkred;">"###########################################"</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Blue</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Write-Host</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: darkred;">'$prefered_list = Get-WinUserLanguageList'</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Blue</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: darkblue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">For</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> (<span style="color: #a82d00;">$i</span> <span style="color: dimgrey;">=</span> <span style="color: purple;">0</span>; <span style="color: #a82d00;">$i</span> <span style="color: dimgrey;">-ne</span> <span style="color: #a82d00;">$installed_lp</span><span style="color: dimgrey;">.</span>Count; <span style="color: #a82d00;">$i</span><span style="color: dimgrey;">++</span>) {</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">Write-Host</span> <span style="color: darkred;">'$prefered_list.Add('</span> <span style="color: #a82d00;">$installed_lp</span><span style="color: dimgrey;">[</span><span style="color: #a82d00;">$i</span><span style="color: dimgrey;">]</span> <span style="color: darkred;">')'</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Blue</span></span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;">}</span></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="background: white; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">Write-Host</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: darkred;">'Set-WinUserLanguageList($prefered_list) -Force'</span> <span style="color: navy;">-ForegroundColor</span> <span style="color: blueviolet;">Blue</span></span></div></td></tr></tbody></table>