---
layout: post
title:  "Microsoft SQL and Microsoft SQL AlwaysOn basics for Citrix Admins"
date:   2018-01-08 20:07:00 +0100
categories:  Failover cluster, Clustering, AlwaysOn, BAGs, multi-subnet, SQL Server 2016 Standard, SQL Server, Basic Availability Groups
---

As a Citrix Consultant I’ve gained a lot of knowledge about Microsoft SQL and Microsoft SQL AlwaysOn over the years. I want to share my SQL knowledge with you. Please keep in mind that I’m a Citrix guy and not a SQL guru.  
   
In the next blogs I’m going to share my knowledge about connecting Citrix Provisioning Services, Citrix XenDesktop and Citrix XenMobile to a multi subnet SQL AlwaysOn cluster.  
   
This blog covers the following topics:  
*   How much memory does my SQL server need? (Page Life Expectancy)
*   Limit SQL Server memory
*   Creating (Basic) AlwaysOn High Availability Groups
*   SQL accounts and AlwaysOn failover, why logging in after a failover doesn’t work OOTB
*   SQL accounts and AlwaysOn failover, copy SQL users to AlwaysOn replica servers
*   Performing an AlwaysOn database failover

How much memory does my SQL server need?
----------------------------------------
SQL-servers will perform better when a lot of memory is added and assigned to Microsoft SQL server. Adding to much memory is inefficient for your virtualized infrastructure. You do not want to have a SQL-memory monster of 64GB of RAM. And when using SQL AlwaysOn two or more of these monsters will cost you a lot of MEM!  
  
When it comes to memory sizing or SQL performance troubleshooting, you can simply monitor the “**Page Life Expectancy**” perfmon counter of the **SQLServer: Buffer Manager**.  
  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image001.png)](https://4.bp.blogspot.com/-svNisjikZOQ/WlO2xzIS3yI/AAAAAAAACJ8/jobPtJ1Cmf0Leb8ClJBlhQ7FQ16oBoPtgCEwYBhgL/s1600/image001.png) This counter represents how long (seconds) a page will live in memory. In other words: “SQL Server can read these pages from memory instead of disk”. The rule of thumb is: The PLE should be 300 seconds (5 minutes) or higher. So if you have a PLE below 300, your SQL-server has not enough memory. Or you have a database/application with a crappy query! In most of the times as an Infrastructure guy, I’m dealing with SQL servers dedicated for Infrastructure purposes: Citrix XenDesktop, VMware vSphere, RES One Workspace, RES One Automation, Ivanti Identity Director, Microsoft WSUS, etc. So PLE for these servers is a good indicator for memory size and performance.  
  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image003.png)](https://1.bp.blogspot.com/-Lsc3mt0jzkA/WlO2x2WLcjI/AAAAAAAACJ0/IRfrXc_8W2UnxoW57UYHYqFiIPQ0mUA7ACEwYBhgL/s1600/image003.png)   
Advise: Add the Page life expectancy to your monitoring tool. If it drops below 300 create warnings.  

Limit SQL Server memory
-----------------------
In the first blog I’ve described the installation and setup of a SQL AlwaysOn availability cluster. In the how-to, we have created a policy where the pages of the SQL server service account are locked in memory and cannot be stored in the page file of the disk (Lock pages in memory). Due to this, it is a good idea to limit your SQL-server so it won’t eat all the memory resources needed by the operating system or other SQL instances on the same SQL server.  
  
You can find the blog here: [https://patrickvandenborn.blogspot.nl/2017/11/how-to-install-and-configure-microsoft.html](https://patrickvandenborn.blogspot.nl/2017/11/how-to-install-and-configure-microsoft.html)  
   
The memory limitation of a SQL instance can be configured as follows:  
1.    Open Microsoft SQL Server Management Studio  
2.    Connect to the SQL server which is hosting the SQL database  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image004.png)]({{ site.url }}/images/2018-01-08/2018-01-08-image004.png)
  
3.    Right click the server and click **Properties**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image005.png)](https://2.bp.blogspot.com/-02V-06yneow/WlO2yCgyurI/AAAAAAAACNE/vZ6xQZlxM4cH6CcstftqiowgBokyuRkzACEwYBhgL/s1600/image005.png)
  
4.    Configure the Maximum server memory for this instance. Rule of thumb give the OS at least 3GB of mem. So in my case: 4 GB – 3 GB OS = 1 GB for SQL Server:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image006.png)](https://4.bp.blogspot.com/-qBiy5VU-_y0/WlO2yKet8hI/AAAAAAAACNA/6BDxSDUopj8f349PaRv5MmVRondJK7ugwCEwYBhgL/s1600/image006.png)  

5.    Restart SQL Service  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image007.png)](https://4.bp.blogspot.com/-j-bVBkIk98c/WlO2yQIjLnI/AAAAAAAACNI/J5a3IIZp2bIew3r8Pcu0zvVEdPxDZHRYQCEwYBhgL/s1600/image007.png)

Creating (Basic) AlwaysOn High Availability Groups
--------------------------------------------------
The creation of a (Basic) AlwaysOn High Availabilty Group is the same for every database. Basic Availabiltity Groups can contain only one database, so for every database a Basic Availability Group is needed. For regular (SQL Enterprise) Availability Groups, you can add more databases to the same availability group.  
  
A database must meet the following conditions to be added to an availability group:  
*   Recovery mode: Full
*   At least one backup of the database is created.

So create a Basic Availability Group as follows:  
1.    Open Microsoft SQL Server Management Studio  
2.    Connect to the SQL server which is hosting the SQL database  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image004.png)]({{ site.url }}/images/2018-01-08/2018-01-08-image004.png)
  
3.    Right click the database and select **Properties**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image008.png)](https://4.bp.blogspot.com/-56pMDcy0a_w/WlO2ytk8rvI/AAAAAAAACNM/QamyoUu5AgIvlTHsfsCDrdc2bt9vNckHQCEwYBhgL/s1600/image008.png)
  
4.    Go to **Options** and verify if the **Recovery model** is set to **Full**. If not, change it to Full. Click **OK**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image009.png)](https://1.bp.blogspot.com/-JYqGunbeY88/WlO2yqBTznI/AAAAAAAACNQ/0O7PtIfYddoyH8gcTSYmTdFNUwEK_Ff1wCEwYBhgL/s1600/image009.png)
 
5.    Right click the database and click **Tasks --> Back Up..**  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image010.png)](https://4.bp.blogspot.com/-ilcSwiB9ZYA/WlO2yz7TsoI/AAAAAAAACNU/jIr1iwu4b6MHBG84tp1GBXl5LOi08CNQQCEwYBhgL/s1600/image010.png)
  
6.    Click **OK**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image011.png)](https://2.bp.blogspot.com/-4R-4UcTJKyo/WlO2zFbu_cI/AAAAAAAACNc/Y8pk-zkaQMYQ7Sz6EuBHCZvuLW_rKVKwwCEwYBhgL/s1600/image011.png)
  
7.    A backup of the database is completed. Click **OK**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image012.png)](https://4.bp.blogspot.com/-MlB76YfZJEs/WlO2zOtLiOI/AAAAAAAACNk/_uEPpT06DiIZSn8eQNlHJpvgL2zssmo1wCEwYBhgL/s1600/image012.png)
  
8.    Right click **Availability Groups** and click **New Availability Group Wizard…**  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image013.png)](https://4.bp.blogspot.com/-yAITJo7jp_U/WlO2zTcWZFI/AAAAAAAACNs/-ss4xFfDl7cyzSK1Me5OtqQelvUszK1lgCEwYBhgL/s1600/image013.png)
 
9.    Welcome page for availability group wizard, click **next**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image014.png)](https://3.bp.blogspot.com/-StLfrV24g88/WlO2zrykNFI/AAAAAAAACN0/7Fg-3B2zQfMPvT2_Iq0_ch8DmffbaZxGwCEwYBhgL/s1600/image014.png)
  
10.    Enter the name for the new availability group and click **Next**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image015.png)](https://2.bp.blogspot.com/-ogZtcEhcbJA/WlO2zt9YRhI/AAAAAAAACN8/_v5CZpJW4bAw2baRmiJDjZPBY7_Ic6NbgCEwYBhgL/s1600/image015.png)
  
11.    Select the database for the availability group (only multiple when using SQL Enterprise Availability Groups), click **Next**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image016.png)](https://2.bp.blogspot.com/-67maBRT4c-Q/WlO2zqdBMHI/AAAAAAAACOE/57HM7ENJBDsHi3LfBmpzL_0dl2XL7Tc3wCEwYBhgL/s1600/image016.png)
  
12.    Click **Add Replica..**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image017.png)](https://4.bp.blogspot.com/-aHhLmhQcN78/WlO2z5gvM_I/AAAAAAAACOM/sh65lu8BwRYQCDwybc21vJGo9nexRrlzQCEwYBhgL/s1600/image017.png)
  
13.    Add SQL server for secondary replica, and click **Connect**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image018.png)](https://3.bp.blogspot.com/-6PNbv1PiOO4/WlO20iiZLoI/AAAAAAAACOU/ln3eqwrHVEAzThVljGbsgKD3wTsGFJBEACEwYBhgL/s1600/image018.png)
  
14.    Select **Automatic Failover** and ensure **Availability mode: Synchronous commit**. Click **Listener** tab:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image019.png)](https://2.bp.blogspot.com/-CkDcgyF7KzE/WlO20n49NII/AAAAAAAACOc/Do8A_OEib4IjkMdeMaqCAxM6oqQk7dvwgCEwYBhgL/s1600/image019.png)
  
15.    Enter **DNS Name** for the new Listener. Enter default SQL port **1433**. Click **Add** to add IP’s for this listener:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image020.png)](https://4.bp.blogspot.com/-dO6blu68I_I/WlO20yd17nI/AAAAAAAACOg/lYXyx_8dZuMdR6q-mZot7djJpt9kLKLAgCEwYBhgL/s1600/image020.png)
  
16.    Enter the **IP-address** for the listener. If multi subnet failover cluster is configured, enter IP-address for all the possible failover subnets (in this example 2 subnets):  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image021.png)](https://3.bp.blogspot.com/-rDbJnCTOPZU/WlO203z7JmI/AAAAAAAACOo/__c18WvF8gwWqWjWZECjh72S9p3os6j3wCEwYBhgL/s1600/image021.png)
  
17.    Listener **IP** for subnet 2:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image022.png)](https://2.bp.blogspot.com/-1ZlogqUxeMM/WlO21ILAJ8I/AAAAAAAACOw/EeqlZwrTL6A_AeO27V0H1M8j5rOS4QzuQCEwYBhgL/s1600/image022.png)
  
18.    Click **Next**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image023.png)](https://4.bp.blogspot.com/-McvVHizO1gM/WlO21DTIj2I/AAAAAAAACO4/JXsf5RbRTrsxHCvI0LdMwfh_DBaQP93UQCEwYBhgL/s1600/image023.png)
  
19.    Select **Full database and log backup** for the initial seeding to the second SQL-server. Use a temporary **file share**. Click **Next**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image024.png)](https://1.bp.blogspot.com/-e4xfgofIVAY/WlO21FYTlvI/AAAAAAAACPA/pZjID716_as6Xow1Agpi3XkYAZbH4oKVwCEwYBhgL/s1600/image024.png)
  
20.    The availability group is verified, click **Next**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image025.png)](https://2.bp.blogspot.com/-2khHEMB_xfI/WlO21bfyUAI/AAAAAAAACPI/RzH09Kjd2rwTwyINBYSnMC29wlALw_bVwCEwYBhgL/s1600/image025.png)
  
21.    An overview of the availability group, click **Finish** to create the availability group:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image026.png)](https://2.bp.blogspot.com/-B-fiq9MSLTs/WlO21l1Pg9I/AAAAAAAACPQ/twDu90ZyVVc9ZQRSKceS-k9Iq9kaDkJmgCEwYBhgL/s1600/image026.png)
  
22.    Configuring the availability group:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image027.png)](https://4.bp.blogspot.com/-8nx8G5KCSb4/WlO21hZeOBI/AAAAAAAACPg/Yy4QwUk96-MNpcMvHCgyGrAZbGw3zN0_ACEwYBhgL/s1600/image027.png)
 
23.    The availability group created successfully, click **Close**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image028.png)](https://1.bp.blogspot.com/-XbOarBV4SMc/WlO21mD9yzI/AAAAAAAACPY/ZPfyoPoCzxMMAmt48m-ibV1vKRYaESsKwCEwYBhgL/s1600/image028.png)
  
New created availability group:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image029.png)](https://4.bp.blogspot.com/-5syqsKo9I-c/WlO22MU9yoI/AAAAAAAACPo/PYwhnepGJ-45HJJjv5iTmCD0r0hjB0e5wCEwYBhgL/s1600/image029.png)
  
Multi subnet DNS-records for Availability Group Listener:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image030.png)](https://3.bp.blogspot.com/-FFusLcdLHfo/WlO22BK-BGI/AAAAAAAACPw/6FX3bdQAhvI9DASnp0Da078TU6G8PelRgCEwYBhgL/s1600/image030.png)
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image031.png)](https://3.bp.blogspot.com/-Ab7DLzbkWzU/WlO22YU4UOI/AAAAAAAACP4/vCVYIVvC9VcK47QwcU0rC7JLf8Js5-TKgCEwYBhgL/s1600/image031.png)

SQL accounts and AlwaysOn failover, why logging in after a failover doesn’t work OOTB
-------------------------------------------------------------------------------------
When using SQL accounts with a AlwaysOn cluster, logging in with SQL accounts after a database failover doesn’t work out of the box. The reason for this is, that the failover SQL servers doesn’t have the correct SQL-server login for that particular SQL user by default. So the SQL-server is denying the login from the server level.   
  
Some products in the end user computing industry like RES/Ivanti are configured with SQL user accounts. So additional configuration is needed when using SQL user accounts with AlwaysOn.  
  
**_Screenshots of “the problem”_**  
So I’ve created a Basic Always On high availability group with database **PBO-SQLDB-withSQLuser**. The SQL user **PBO-SQLUser** is configured as dbo for the database **PBO-SQLDB-withSQLuser**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image032.png)](https://2.bp.blogspot.com/-hC9R_YhwTpU/WlO22dcxKYI/AAAAAAAACQA/yWtI4npaTYwuerDwRQxSaeu-XQwls5ePACEwYBhgL/s1600/image032.png)

  
The SQL Server **PBO-SQL01** does have a SQL user **PBO-SQLUser** because the database and user is initially created on **PBO-SQL01**. When the “Basic” AlwaysOn Availability Group is created, the SQL users of that database are not synchronized to the other Availability Replica Server **PBO-SQL02**. Active Directoy users and groups will be synced to the other Availability replica servers.  
  
SQL server logins of **PBO-SQL01**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image033.png)](https://4.bp.blogspot.com/-JWgPBGm_tFI/WlO22pALnkI/AAAAAAAACQI/a2wyy12SIJYiDTVJ0HoXZ-00zMqFaDYGwCEwYBhgL/s1600/image033.png)

  
SQL Server logins of **PBO-SQL02**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image034.png)](https://4.bp.blogspot.com/-f9yO1a21GyU/WlO22rcynZI/AAAAAAAACQQ/jvaSSnkbp9AOPea-keDKjOOhVnP7kZ1bgCEwYBhgL/s1600/image034.png)
 
When testing the ODBC-resource with **PBO-SQL01** as primary SQL Replica server:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image035.png)](https://4.bp.blogspot.com/-0yzHw-ZgdxU/WlO22-R6oOI/AAAAAAAACQY/6hpdSwwovls2NQb_3wdNiEghHr12T90FwCEwYBhgL/s1600/image035.png)
  
When testing the ODBC-resource with **PBO-SQL02** as primary SQL Replica server:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image036.png)](https://3.bp.blogspot.com/-egY7_-QSWKg/WlO22_-KbhI/AAAAAAAACQg/v_I5-KNhpXEJpOC41zST2Lw9nj8Qr-0tQCEwYBhgL/s1600/image036.png)
  
After failover the SQL user is in the security of the database, but there is no SQL login for the SQL server:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image037.png)]({{ site.url }}/images/2018-01-08/2018-01-08-image037.png)
  
So logging in with the SQL username and password will fail after database failover to the second SQL AlwaysOn Replica Server:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image038.png)](https://4.bp.blogspot.com/-9biWRQNQfI4/WlO23lGDdbI/AAAAAAAACQo/5A1k_T_6dHcplbGLvOFGLyHIWuonRdyIQCEwYBhgL/s1600/image038.png)  

SQL accounts and AlwaysOn failover, copy SQL users to AlwaysOn replica servers
------------------------------------------------------------------------------
Add the SQL user(s) with the same SID, username and password to all other AlwaysOn replica servers as follows:  
1.    Open Microsoft SQL Server Management Studio  
2.    Connect to the source SQL server where the SQL-users are configured  

[![]({{ site.url }}/images/2018-01-08/2018-01-08-image004.png)]({{ site.url }}/images/2018-01-08/2018-01-08-image004.png)
  
3.    Click on the **SQL-server** and click **New Query**  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image039.png)](https://1.bp.blogspot.com/-3JwXcQvThH4/WlO24ANrI8I/AAAAAAAACQ4/Nt1awOzxxEQxmBl4GCb8eqHTlvafEdDkgCEwYBhgL/s1600/image039.png)
  
4.    Paste the following SQL Query and press **Execute**  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image040.png)](https://3.bp.blogspot.com/-vRaZ6ozd-D0/WlO24Tn7SyI/AAAAAAAACRA/VW-PcVQEagk7yeqXK9lHEnkKw_V1X0e_ACEwYBhgL/s1600/image040.png)

SQL Query:  
  
**

<table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid" style="border-collapse: collapse; border: none; mso-border-alt: solid windowtext .5pt; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-yfti-tbllook: 1184;"><tbody><tr style="mso-yfti-firstrow: yes; mso-yfti-irow: 0; mso-yfti-lastrow: yes;"><td style="border: solid windowtext 1.0pt; mso-border-alt: solid windowtext .5pt; padding: 0cm 5.4pt 0cm 5.4pt; width: 450.8pt;" valign="top" width="601"><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">USE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">master</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">GO</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">OBJECT_ID</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'sp_hexadecimal'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">IS</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NOT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NULL</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DROP</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PROCEDURE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> sp_hexadecimal</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">GO</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">CREATE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PROCEDURE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> sp_hexadecimal</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>@binvalue </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varbinary</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">256</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">),</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>@hexvalue </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">514</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">OUTPUT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">AS</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @charvalue </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">514</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @i </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @length </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @hexstring </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">char</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">16</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @charvalue </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'0x'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @i </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 1</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @length </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">DATALENGTH</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@binvalue</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @hexstring </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'0123456789ABCDEF'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHILE </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@i </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">&lt;=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @length</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tempint </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @firstint </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @secondint </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tempint </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">CONVERT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">SUBSTRING</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@binvalue</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@i</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">))</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @firstint </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">FLOOR</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@tempint</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">/</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">16</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @secondint </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tempint </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">-</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@firstint</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">*</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">16</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @charvalue </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @charvalue </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">SUBSTRING</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@hexstring</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @firstint</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">SUBSTRING</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@hexstring</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @secondint</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @i </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @i </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 1</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @hexvalue </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @charvalue</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">GO</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">OBJECT_ID</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'sp_help_revlogin'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">IS</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NOT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NULL</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DROP</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PROCEDURE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> sp_help_revlogin</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">GO</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">CREATE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PROCEDURE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> sp_help_revlogin @login_name </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">sysname</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NULL</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">AS</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">sysname</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @type </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @hasaccess </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @denylogin </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_disabled </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">int</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @PWD_varbinary<span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varbinary </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">256</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @PWD_string<span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">514</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @SID_varbinary </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varbinary </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">85</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @SID_string </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">514</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr<span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">1024</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_policy_checked </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">3</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_expiration_checked </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">3</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @defaultdb </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">sysname</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@login_name </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">IS</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NULL)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">CURSOR</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FOR</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">sid</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">type</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">is_disabled</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">default_database_name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> l</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">hasaccess</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> l</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">denylogin </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FROM</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">sys</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">server_principals</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">LEFT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">JOIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">sys</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">syslogins</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> l</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">ON </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> l</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHERE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">type</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">IN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'S'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'G'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'U'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">AND</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">&lt;&gt;</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'sa'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">ELSE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DECLARE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">CURSOR</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FOR</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">sid</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">type</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">is_disabled</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">default_database_name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> l</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">hasaccess</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> l</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">denylogin </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FROM</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">sys</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">server_principals</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">LEFT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">JOIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">sys</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">syslogins</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> l</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">ON </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> l</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHERE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">type</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">IN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'S'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'G'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'U'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">AND</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> p</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @login_name</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">OPEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FETCH</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">NEXT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FROM</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">INTO</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @SID_varbinary</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @type</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_disabled</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @defaultdb</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @hasaccess</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @denylogin</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">@@fetch_status</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">-</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PRINT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'No login(s) found.'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">CLOSE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DEALLOCATE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">RETURN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">-</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">1</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'/* sp_help_revlogin script '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PRINT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'** Generated '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">CONVERT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varchar</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">GETDATE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">())</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">' on '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">@@SERVERNAME</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">' */'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PRINT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PRINT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">''</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHILE </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">@@fetch_status</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">&lt;&gt;</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">-</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">@@fetch_status</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">&lt;&gt;</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">-</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">2</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PRINT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">''</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'-- Login: '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PRINT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@type </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">IN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'G'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'U'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">))</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: green; font-size: 9.5pt;">-- NT authenticated account/group</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'CREATE LOGIN '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">QUOTENAME</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">' FROM WINDOWS WITH DEFAULT_DATABASE = ['</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @defaultdb </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">']'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">ELSE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: green; font-size: 9.5pt;">-- SQL Server authentication</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: green; font-size: 9.5pt;">-- obtain password and sid</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @PWD_varbinary </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">CAST</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">LOGINPROPERTY</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'PasswordHash'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">AS</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">varbinary </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">256</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">EXEC</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> sp_hexadecimal</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@PWD_varbinary</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @PWD_string </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">OUT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">EXEC</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> sp_hexadecimal</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@SID_varbinary</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@SID_string </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">OUT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: green; font-size: 9.5pt;">-- obtain password policy state</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_policy_checked </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">CASE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> is_policy_checked </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 1 </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">THEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'ON'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 0 </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">THEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'OFF'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">ELSE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NULL</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FROM</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">sys</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">sql_logins</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHERE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SELECT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_expiration_checked </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">CASE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> is_expiration_checked </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 1 </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">THEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'ON'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 0 </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">THEN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'OFF'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">ELSE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NULL</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FROM</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">sys</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">.</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: lime; font-size: 9.5pt;">sql_logins</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">WHERE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'CREATE LOGIN '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">QUOTENAME</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">' WITH PASSWORD = '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @PWD_string </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">' HASHED, SID = '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @SID_string </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">', DEFAULT_DATABASE = ['</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @defaultdb </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">']'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_policy_checked </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">IS</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NOT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NULL</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">', CHECK_POLICY = '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_policy_checked</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_expiration_checked </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">IS</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NOT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">NULL</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">', CHECK_EXPIRATION = '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_expiration_checked</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@denylogin </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: green; font-size: 9.5pt;">-- login is denied access</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'; DENY CONNECT SQL TO '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">QUOTENAME</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">ELSE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@hasaccess </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 0</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: green; font-size: 9.5pt;">-- login exists but does not have access</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'; REVOKE CONNECT SQL TO '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">QUOTENAME</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">IF </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;">@is_disabled </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 1</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">BEGIN</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: green; font-size: 9.5pt;">-- login is disabled</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">SET</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">=</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">'; ALTER LOGIN '</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: magenta; font-size: 9.5pt;">QUOTENAME</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">(</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">)</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">+</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: red; font-size: 9.5pt;">' DISABLE'</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">PRINT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @tmpstr</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FETCH</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">NEXT</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">FROM</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs </span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">INTO</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @SID_varbinary</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @name</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @type</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @is_disabled</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @defaultdb</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @hasaccess</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: grey; font-size: 9.5pt;">,</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> @denylogin</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span></span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">END</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">CLOSE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">DEALLOCATE</span><span lang="EN-US" style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> login_curs</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">RETURN</span><span style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"> 0</span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span style="background: white none repeat scroll 0% 0%; color: blue; font-size: 9.5pt;">GO</span><span style="background: white none repeat scroll 0% 0%; color: black; font-size: 9.5pt;"></span></div></td></tr></tbody></table>

** 5.    Then execute SQL Query:  
<table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid" style="border-collapse: collapse; border: none; mso-border-alt: solid windowtext .5pt; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-yfti-tbllook: 1184;"><tbody><tr style="mso-yfti-firstrow: yes; mso-yfti-irow: 0; mso-yfti-lastrow: yes;"><td style="border: solid windowtext 1.0pt; mso-border-alt: solid windowtext .5pt; padding: 0cm 5.4pt 0cm 5.4pt; width: 450.8pt;" valign="top" width="601"><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm;"><span style="font-family: &quot;Trebuchet MS&quot;, sans-serif;">exec sp_help_revlogin<span lang="EN-US" style="mso-ansi-language: EN-US;"></span></span></div></td></tr></tbody></table>
  
6.    The result of the query is a message with SQL queries to create the SQL Login on other SQL servers with the same SID, username and password. So copy all queries for SQL-users you want to copy to the other SQL AlwaysOn Replica servers:  

[![]({{ site.url }}/images/2018-01-08/2018-01-08-image041.png)](https://4.bp.blogspot.com/-EexuPe4fte8/WlO24X4kS9I/AAAAAAAACRI/NNvewG2uxM4-lz8iqDh8SO49NGjqEt0FQCEwYBhgL/s1600/image041.png)Example:  

<table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid" style="border-collapse: collapse; border: medium none; height: 79px; margin-left: 36pt; width: 1340px;"><tbody><tr style="mso-yfti-firstrow: yes; mso-yfti-irow: 0; mso-yfti-lastrow: yes;"><td style="border: solid windowtext 1.0pt; mso-border-alt: solid windowtext .5pt; padding: 0cm 5.4pt 0cm 5.4pt; width: 450.8pt;" valign="top" width="601"><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm;"><span style="font-family: &quot;Trebuchet MS&quot;, sans-serif;"><span lang="EN-US" style="mso-ansi-language: EN-US;">-- Login: PBO-SQLUser</span></span></div><div class="MsoListParagraph" style="line-height: normal; margin-bottom: .0001pt; margin: 0cm; mso-add-space: auto;"><span style="font-family: &quot;Trebuchet MS&quot;, sans-serif;"><span lang="EN-US" style="mso-ansi-language: EN-US;">CREATE LOGIN [PBO-SQLUser] WITH PASSWORD = 0x0200751C9E00619211DF04A81F0CABAB80BD6D17E27C27F7911139F882E78DA5BEAE21DD94F05959C8BF2DEB72560DD737C2DC806E4D1A8F7CCAA64A48E533033AF10E7D5D53 HASHED, SID = 0xB5772CBA98308B46BAE4DD13FB6D3CE2, DEFAULT_DATABASE = [master], CHECK_POLICY = OFF, CHECK_EXPIRATION = OFF</span></span></div></td></tr></tbody></table>

7.    Login to the second SQL Availability Replica Server:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image042.png)](https://1.bp.blogspot.com/-uB-u-coQaVE/WlO24ngaBSI/AAAAAAAACRU/dwAjqkHB4sQPvIXM2bqB2NhuATcUQIhmgCEwYBhgL/s1600/image042.png)
  
8.    Click on the **destination SQL-server** followed by **New Query**  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image043.png)](https://3.bp.blogspot.com/-VEwBpVHJUtY/WlO24skTUXI/AAAAAAAACRg/_f04VZkd6qUSFULbssU8I288LP39FAwnQCEwYBhgL/s1600/image043.png)
  
9.    Paste the new **SQL user login query** and **execute**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image044.png)](https://1.bp.blogspot.com/-63C8ko1zWf0/WlO249QAhhI/AAAAAAAACRo/aE-AiPIEDXMjadkEGELpmod04h4Dj4IcgCEwYBhgL/s1600/image044.png)
  
10.    The user is created with the correct SID on the other SQL AlwaysOn Replica Server:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image045.png)](https://1.bp.blogspot.com/-VT1PUQNLBo0/WlO24z6upJI/AAAAAAAACR0/x3ZcaTAagK4Zq10Y7fz7YyNOkOcdjHVWQCEwYBhgL/s1600/image045.png)
  
11.    When we test the login again (after AlwaysOn failover):  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image046.png)](https://1.bp.blogspot.com/-vPEpVcNby50/WlO25OmFzEI/AAAAAAAACSI/p29iO643qUMEX_wAr0-mzxIhx7FOeWArwCEwYBhgL/s1600/image046.png)

Performing an AlwaysOn database failover
----------------------------------------
You can perform a database failover or failback as follows:  
1.    Open Microsoft SQL Server Management Studio  
2.    Connect to a SQL AlwaysOn Availibilty Replica  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image004.png)](https://3.bp.blogspot.com/-7yKIWN0-DWE/WlO2yFs-o1I/AAAAAAAACS8/98qXIWNIES8e37UvUlCowOMjO1m9RmI2QCEwYBhgL/s1600/image004.png)
  
3.    Right click on the **Availability group** and click **Failover…**  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image047.png)](https://3.bp.blogspot.com/-DQwNmVi8QbU/WlO25T0Gg6I/AAAAAAAACR8/zyX7OJgly7856jQnXehpSWYwZW-U5gVQwCEwYBhgL/s1600/image047.png)
  
4.    Failover welcome page, click **Next**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image048.png)](https://4.bp.blogspot.com/-McDrGId4wuA/WlO26BReZ6I/AAAAAAAACSc/eEOWcvnlfm484o4J6n8UzctZRE66VUpOACEwYBhgL/s1600/image048.png)
  
5.    Select the **new Primary relica** and click **Next**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image049.png)](https://4.bp.blogspot.com/-90aUuvZK-g8/WlO26JasdGI/AAAAAAAACSQ/5_p5BO2rGy4T56CBoCqtiAEP97E-lHdWACEwYBhgL/s1600/image049.png)
  
6.    Check the failover and click **Finish**:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image050.png)](https://1.bp.blogspot.com/-q1ZsnmFS__0/WlO26CXFx7I/AAAAAAAACSo/9zj-irgU0h4JA54UR1yYLZAIcZeuAiwbwCEwYBhgL/s1600/image050.png)
  
7.    Failover or Failback completed:  
[![]({{ site.url }}/images/2018-01-08/2018-01-08-image051.png)](https://4.bp.blogspot.com/-L6EvV6Yb1To/WlO26TVi7NI/AAAAAAAACSw/VLtwU4l4ryEaFl0Movd_9V4RotZsuVpFQCEwYBhgL/s1600/image051.png)